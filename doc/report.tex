\documentclass[12pt,a4paper]{article}
\usepackage{russ}
\usepackage[english,russian]{babel}
\usepackage{microtype}
\usepackage{csquotes}
\usepackage{amsmath}
\usepackage{amsthm}
\usepackage{amssymb}
\usepackage{mathtext}
\usepackage[notrig]{physics}
\usepackage{newfloat}
\usepackage{caption}
\usepackage{indentfirst}
\usepackage{geometry}
\usepackage{hyperref}
\usepackage{mdframed}
\usepackage[inline]{enumitem}
\usepackage{graphicx}
\usepackage{subfig}
\DeclareGraphicsExtensions{.pdf,.png,.jpg,.PNG}
\graphicspath{{./img/}}
\captionsetup[figure]{justification=centering}
\renewcommand{\thesubfigure}{\asbuk{subfigure}}
\DeclareCaptionLabelSeparator{dotseparator}{. }
\captionsetup{labelsep=dotseparator}

\begin{document}

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Постановка задачи}

        Провести процедуру триангуляции Делоне на плоскости случайно сгенерированного набора точек. Построить разбиение Дирихле для данной плоскости.

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Триангуляция Делоне}

        Триангуляция Делоне~--- триангуляция заданного набора точек, при которой точки, образующие треугольник, являются ближайшими соседями.

        Построение данной триангуляции основывается на правиле Делоне: три точки из некоторого множества точек удовлетворяют условию триангуляции (входят в триангуляцию в качестве треугольника) тогда и только тогда, когда в описанную вокруг них окружность не входит ни одной другой точки этого множества.

        Не сложно придумать простейший алгоритм построения данной триангуляции~--- метод простого перебора. Как ясно из названия, он сводится к перебору всех возможных троек точек и проверке для них условия Делоне. В наивной реализации временная сложность данного алгоритма достаточно высока~--- $\order{N^4}$. Это накладывает ограничения на применимость алгоритма к построению больших сеток.

        Более оптимальным является рекуррентный алгоритм. Он состоит в последовательном добавлении новых узлов в триангуляцию и локальной перестройке уже имеющейся триангуляции. Условие Делоне фактически означает, что перестраивать уже найденное решение для $N-1$ точек необходимо лишь в некоторой сравнительно небольшой окрестности $N$-ной точки. Более конкретно, необходимо удалить из существующей триангуляции те треугольники, для которых $N$-ная точка нарушает условие Делоне, и провести триангуляцию между вершинами удаленных треугольников $N$-ной точкой.

        Следует иметь в виду, что триангуляция Делоне некоторого множества точек порождает выпуклую область на плоскости. Область, занимаемая удаленными треугольниками, может не быть выпуклой, и триангуляция, проведенная на вершинах этих треугольников, может дать \enquote{лишние} треугольники, дополняющие невыпуклую область до выпуклой. Лишние треугольники не имеют $N$-ной точки в качестве своей вершины, потому легко убираются из решения.

        \enquote{Начальное решение}, т.е. исходная триангуляция для рекуррентного алгоритма обычно строится методом перебора по т.н. точкам сверхструктуры~--- узловым точкам некоторой ограничивающей области (обычно~--- узловые точки квадрата, треугольника, шестиугольника, точки на окружности и т.д.). После окончания рекуррентной процедуры точки сверхструктуры и соответствующие им треугольники удаляются из триангуляции.

        Учитывая, что для построения триангуляции из $N$ точек в рекуррентном алгоритме по прежнему необходимо производить проверку условия Делоне ($\sim M$ проверок критерия на $M$-ю добавляемую точку), а также производить поиск треугольников, для которых добавляемая точка нарушает это условие (также $K \sim 2M$ проверок на $M$-ю добавляемую точку, где $K$~--- количество треугольников в триангуляции), временная сложность отдельных итераций алгоритма $\order{M^2}$, а всего алгоритма~--- все еще $\order{N^3}$, что также неприемлемо для больших сеток.

        Эффективность алгоритма можно существенно повысить, если вместо перебора всех $M$ точек и всех $K$ треугольников использовать связность триангуляции. Однако более простое и, вероятно, быстрое решение~--- использовать дерево квадрантов.

        Дерево квадрантов~--- обобщение бинарного дерева на двумерные данные. Корневой узел связан с некоторой прямоугольной областью. Данная область делится на четыре равные части (квадранты) двумя прямыми. Четырем дочерним узлам дерева ставятся в соответствие четыре квадранта области, связанной с родительским узлом.

        Дерево вершин и дерево описанных окружностей позволяют снизить временную сложность поиска по плоскости до $\sim \order{\log{M}}$.

        С триангуляцией Делоне тесно связано разбиение Дирихле. Для данной вершины ячейка Дирихле~--- выпуклый многоугольник, построенный на центрах описанных окружностей соседних к вершине треугольников.

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Анализ результатов}

        В ходе работы была написана демонстрационная программа (\autoref{fig:mainwindow}) на языке  \enquote{C++}, строящая триангуляцию Делоне и разбиение Дирихле разных наборов точек.
        %
        \begin{figure}[h]
            \centering
            \includegraphics[width=1\textwidth]{mainwindow}
            \caption[]{Главное окно программы}
            \label{fig:mainwindow}
        \end{figure}
        %
        Программа имеет несколько тестовых наборов точек: полностью случайная сетка (\autoref{fig:rand}-\autoref{fig:rand_dir}), случайная сетка, близкая к прямоугольной (\autoref{fig:rect}-\autoref{fig:rect_dir}), прямоугольная сетка, а также несколько специальных сеток: квадрат и шестиугольник.

        \begin{figure}[h]
            \centering
            \includegraphics[width=1\textwidth]{rand}
            \caption[]{Триангуляция случайной сетки}
            \label{fig:rand}
        \end{figure}
        %
        \begin{figure}[h]
            \centering
            \includegraphics[width=1\textwidth]{rand_dir}
            \caption[]{Разбиение Дирихле случайной сетки}
            \label{fig:rand_dir}
        \end{figure}
        %
        \begin{figure}[h]
            \centering
            \includegraphics[width=1\textwidth]{rect}
            \caption[]{Триангуляция близкой к прямоугольной сетки}
            \label{fig:rect}
        \end{figure}
        %
        \begin{figure}[h]
            \centering
            \includegraphics[width=1\textwidth]{rect_dir}
            \caption[]{Разбиение Дирихле близкой к прямоугольной сетки}
            \label{fig:rect_dir}
        \end{figure}

        Были произведены приблизительные замеры производительности построения триангуляции близкой к прямоугольной сетки из $100 \times 100$ узлов. Устранение всех операций вычисления корня увеличило производительность программы в $\sim 100$ раз. Использование дерева вершин глубины $5-6$ узлов дало ускорение в $\sim 10$ раз. Добавление дерева описанных окружностей дало прирост скорости работы в $\sim 1.5$ раза.

        Для каждой триангуляции оценивалась интегральная мера невырожденности ее треугольников, вычисляемая как средний минимальный угол в треугольнике, составляющем триангуляцию, деленный на $60^\circ$. Для случайной сетки эта мера с небольшими отклонениями составила $\sim 0.5$, тогда как для прямоугольной сетки~--- $0.75$. Треугольники сверхструктуры при расчетах не учитывались.

    %
    %
    %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %                           SECTION                                   %
    %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
    %
    %
    %

    \section{Выводы}

        В ходе работы была написана демонстрационная программа, позволяющая строить триангуляцию произвольного набора точек.

        Были сделаны выводы о сложности построения триангуляции Делоне и о способах ускорения алгоритмов.

\end{document}
